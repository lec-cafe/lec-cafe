# コンテナとレイアウト

CSSのベースを構築する上で、コンテナとレイアウトの設計は非常に重要です。

コンテナやレイアウトのような要素の配置の設計を適切に行う事により、
変更に強く管理しやすいCSS構築することができます。

柔軟に変化に対応できるWebデザインを実現するために、
コンテナとレイアウトの設計の基本を学んで行きましょう。

## 基本のCSSの考え方

Photoshopなどのデザインツールと、CSSにおけるコーディングでは、
要素のレイアウト、フロー構造に対する考え方が大きく異なります。

Photoshopなどのデザインツールでは1つの要素でデザインに変化を起こしても、その影響はそのオブジェクト内で完結しますが、
CSSは一つの要素の変化が、他の要素に対して大きな影響を及ぼすケースがあります。

例えば親子関係にある要素では、子要素のサイズの変化が親要素のサイズに影響しますし、
垂直に並ぶ兄弟要素についても、上部の要素のサイズが変化すれば下部に位置する要素の表示位置は変化します。
水平に並ぶ兄弟要素のサイズの変更は、他の要素の標示サイズを圧迫したり、
ときには改行を発生させたりするケースもあります。

CSSで変化に強いデザインを表現するには、ブロックの考え方がとても重要です。
各ブロック内で発生する変更が、他のブロックに影響を及ぼさないようにコーディングを進めることで、
変化に強いCSSコーディングを進めることができます。

## コンテナ

コンテナは、Webサイトを構築する上で重要な要素です。
コンテナは、画面の水平レベルでの制御範囲を定義する役割を持ちます。

コンテナは画面内のコンテンツの収まる範囲を設定するブロックで、
コンテンツを一定の範囲内で整列させる役割を持ちます。

### PC画面でのコンテナ

一般的にPC向けのサイトデザインでは、700 - 1500 px程度の幅のコンテナを設定します。

![](/images/sec1/container.png)

PC画面のコンテナサイズは画面幅よりも小さく設定されることがほとんどです。
コンテナの設定を行わず、画面幅全体に対して要素を配置する場合、例えば4Kなどの大きな画面で閲覧した際に、
テキストの折返しがほとんど起こらなくなり、無駄に細長く展開されるテキストのラインがデザイン上の美観を損ねたり、
画面サイズの変化によるテキスト折り返し量の違いでテキスト表現の高さが不安定になる、といった問題があります。

### SP画面でのコンテナ

SP画面でのコンテナは、画面のサイズに対して100％ の幅が取られるケースがほとんどです。

SP画面でのコンテナは、コンテナサイズ = 画面幅とすることで、
画面上の横スクロールを防ぐといった役割があります。

画面100％ でコンテナを設定する都合上、コンテンツ表示領域の幅は柔軟に変化します。
横並びの要素などは、SPの標示範囲内で適切に表示されるよう工夫を施す必要があります。

またコンテナが画面幅100％ と言っても、画面縁ギリギリまで要素を配置したいケースは少ないでしょう。
画面の左右に適切な余白を設定したい場合、コンテナの左右に適切なパディングを設けて非表示領域を設定しましょう。

### コンテナとコーディング

コンテナをCSSで表現する場合、以下のようなコードになります。

```css
.container{
    width: 100%;
    max-width: 784px;
    margin-right: auto;
    margin-left: auto;
}
```

これを使ってHTMLを記述する場合、以下のような形になるでしょう。

```html
<div class="container">
    <section class="header"> ... </section>
    <section class="hero"> ... </section>
    <section class="about"> ... </section>
    <section class="service-list"> ... </section>
    <section class="contact"> ... </section>
    <section class="footer"> ... </section>
</div>
```

全ての要素をコンテナ要素の内部に配置するコーディングはシンプルでわかりやすい反面、
コンテナの外部に何も装飾を施せないという欠点があります。

通常、コンテナの外部にはコンテンツを配置しませんが、
背景色や罫線などはコンテナを突き抜けて、画面全体に展開したいケースもあるでしょう。
(上記コンテナイメージ画像のファーストビュー箇所など参考）

```html
<section class="header">
    <div class="container"> ... </div>
</section>
<section class="hero">
    <div class="container"> ... </div>
</section>
<section class="about">
    <div class="container"> ... </div>
</section>
<section class="service-list">
    <div class="container"> ... </div>
</section>
<section class="contact">
    <div class="container"> ... </div>
</section>
<section class="footer">
    <div class="container"> ... </div>
</section>
```

上記のようにそれぞれのセクションごとが内部にコンテナを含むようにすれば、
コンテナ外への装飾も簡単に適用することができるようになります。

## HTMLタグの使い方

CSSコーディングだけでなく、適切なHTMLタグを利用することは、
可読性の高いコーディングを行う上で必要不可欠です。

divやspanなどの汎用的なタグは便利な一方、要素の意味合いを見えにくくします。
HTMLには要素の意味合いに応じて様々なタグが利用可能なため、
これを利用することで、HTMLの読みやすさを向上させたり、CSS実装の手間を省けたりします。

### セクショニングコンテンツ 

通常サイト内のコンテンツは、一枚岩でできているのではなく、
複数の意味上のまとまりから構成されています。

サイト内で何らかの意味を持った独立した塊（ｶﾀﾏﾘ)を、
セクショニング・コンテンツといって、
`div` ではでなくセクショニング・コンテンツ用のタグを用いてコーディングされることが推奨されています。

- `section` ページのコンテンツ内でアウトライン上の単位（章・節・項）として成立するまとまり
- `article` ページのコンテンツ内で、独立完結した1つのドキュメントとして捉えられるまとまり
- `aside` ページの主要な要素に対して、補足的なコンテンツとしてのまとまり
- `nav` ページのコンテンツ内で、他のページに対する誘導を行うためのまとまり

セクショニングコンテンツは、それ自体が意味あいを持ったまとまりであるため、
そこには何らかの名前がつけられるはずです。
そのため、セクショニングコンテンツの内部ではh1-6系の見出しタグを利用した見出しの定義が推奨されています。

セクショニングコンテンツの内部には新しいセクショニングコンテンツを記述することも可能です。

```html
<section>
    <h2>私達にできること</h2>
    <p>私達は Web制作事業を通じて、様々なお客様の ... </p>
    <section>
        <h3>メディアサイト制作</h3>
        <p>メディアサイト制作の豊富な事例と実績を基に ...</p>
    </section>
    <section>
        <h3>官公庁向けサイト制作</h3>
        <p>メディアサイト制作の豊富な事例と実績を基に ...</p>
    </section>
</section>
```

セクショニングコンテンツがページ内での意味上の表すのに対し、
`header` や `footer` は、ページ全体または特定のセクション内でのレイアウト上での意味付け（ヘッダー・フッター）を表します。

このため、`header` や `footer` `main`　内への見出し要素の配置は完全に任意となっています。

### その他のHTML要素

クリックされることが期待される要素には、`a` や `button` の要素を用いるのが適切です。
装飾ボタンやクリック領域を `div` や `span` で実装した場合、
JavaScript上でclickイベントが発生しないという問題がiOS Safariで発生します。

この問題はCSS側で `cursor: pointer` のプロパティを定義することで解決可能ですが、
わざわざCSSで特殊なハックを実装するよりも適切なHTMLを利用してコーディングを行うほうが理解しやすいでしょう。

リストの要素は `ul` `ol` `dl` などの要素を用いて記述することもできます。
例えばHTMLをPHPのシステムやjQuery/Vue.jsなどのJSコードへ組み込んで利用する場合、
繰り返しの記述はプログラムの構文を用いて書き換える事があります。
`ul` `ol` `dl` などのリスト要素を用いてコーディングされている場合、
`li` や `dt` `dd` などの要素で繰り返し部分がすぐに判別できるため組み込み時の可読性が非常に高まります。

## 仕様変更に強くする

サイトの仕様が変更されるとサイトの見た目は変更されます。

見た目の変更にはHTMLとCSSの修正が必要となりますが、この修正がなるべく簡単に済むようにコーディングを進めたいものです。

一口に「修正」と言ってもそこには様々な修正があります。

- 文言や画像など既存のコンテンツの差し替え
- コンテンツの重要度や意味合いの変化によるレイアウトの変化・並び替え
- デザイン、レイアウトの趣向の変化

大前提としてあるのは、修正しやすい = 読みやすいということです。

divやspanばかりのHTMLコードよりも、
セクショニングコンテンツや適切なHTMLタグを利用したコードは読みやすく修正もしやすいでしょう。

そもそものデザインの変更に、コーディング上で何か備えられるように…と考えても
こうした可読性程度の問題しか、対策のとりようがありませんが、
その他のコンテンツの変化に対する対応はCSSの工夫で柔軟性を担保することが可能です。

修正に強いCSSを構築するために、どのような対応が取れるかを考えてみましょう。

### コンテンツの差し替えに対する柔軟性

コンテンツの差し替えは、運用上必ず発生しうるものです。

前提として差し替えうる項目と固定の項目を確認しておくのはディレクション上とても重要です。
差し替えうる項目に関しては、コーディング上である程度の柔軟性を担保する必要があります。

画像のコーディングについては、必ず幅 か高さのいずれかを設定するようにしましょう。
幅も高さも設定しない場合、差し替え画像の解像度の変化で画像の表示領域が変化してしまいます。
逆に画像の幅と高さ両方を指定する場合、箚し買えば前後で画像の縦横比が違う場合、画像に歪みが発生してしまいます。

幅か高さで迷った場合、幅を固定に設定するのが良いでしょう。
横の長さが無限に大きくなる場合、コンテナから表示領域が溢れたりして、意図しない横スクロールが発生してしまうなどの問題があります。

文字に関しても文章の溢れを考慮しておくと良いでしょう。
特に表示領域幅の狭いエリアでは、文章量増加に対する行数の増え具合が大きくなります。

またword-breakの設定にも注意が必要です。
URLなどのように、一単語で認識されうる長い英数字が表示される場合、
適切なword-breakの設定がないと表示幅があふれる可能性もあります。

https://developer.mozilla.org/ja/docs/Web/CSS/word-break

### コンテンツの重要度の変化に強くする

文言の差し替えとは別に、運用上の時間経過で、コンテンツの重要度や意味合いが変化するケースもあります。

- 掲載期間が終了したイベント告知領域を削除
- お知らせの掲載件数を3件から6件に変更
- お問い合わせ需要の増加に伴い、問い合わせエリアを画面上部に移動

このようなレイアウト変更や修正に対応するためには、
例えばTwitter BootstrapなどのCSSフレームワークにあるような、
「どこに配置しても適切に機能するCSS」の記述が必要です。

通常、このような仕様変更の要求は、意味上のまとまり、つまりセクショニングコンテンツ単位で起こるケースが多いでしょう。
最低限、セクショニングコンテンツ単位でコンポーネントの考え方を意識したコーディングができれば、
レイアウトの変更に対して強いコンポーネントライクなコードが出来上がります。

セクショニングコンテンツの単位で「どこに配置しても適切に機能するCSS」を実現するには、
厳密にはStyleGuideなどの導入が不可欠ですが、一般的な制作の範囲でそこまでするのは億劫なので、
ここでは押さえて置くべき主要な点についてのみ検討しておきましょう。

#### コードの取りまとめ

コンテンツの変更や削除を行う際に、どのCSSを削除すればよいのか、判断に困るケースは多々あります。

セクショニングコンテンツごとにCSSをまとめて管理するように注意すればこのような問題は少なくなるでしょう。

```html
<section class="newsArea">
    <h2 class="newsArea--title">お知らせ</h2>
    <ul class="newsArea--items">
        <li>
            <article class="newsItem">
                <div class="newsItem--date">2018/11/25</div>
                <div class="newsItem--title">クリスマス限定新商品の予約受け付け中！</div>
                <div class="newsItem--link"><a href="/news/110005">詳細</a></div>
            </article>
        </li>
        <li>
            <article class="newsItem">
                <div class="newsItem--date">2018/10/15</div>
                <div class="newsItem--title">ハロウィンイベント商品の入荷状況について</div>
                <div class="newsItem--link"><a href="/news/110003">詳細</a></div>
            </article>
        </li>
        <li>
            <article class="newsItem">
                <div class="newsItem--date">2018/09/01</div>
                <div class="newsItem--title">台風の影響による発送の遅延について</div>
                <div class="newsItem--link"><a href="/news/110001">詳細</a></div>
            </article>
        </li>
    </ul>
    <div class="newsArea--seeAll">
        <a href="/news/all">すべて見る</a>
    </div>
</div>
```

上記のHTMLでは2つのセクショニングコンテンツが利用されています。

- `section.newsArea` お知らせの表示領域
- `article.newsItem` 1つ一つのお知らせ項目

`section.newsArea` の要素には、クラス名として `newsArea--` の接頭辞がつき、
`article.newsItem` の要素には、クラス名として `newsItem--` の接頭辞がついています。

CSSを記述する際には、以下のようなCSSを書きます。

```css
.newsArea{ ... }
.newsArea .newsArea--title{ ... }
.newsArea .newsArea--items{ ... }
.newsArea .newsArea--seeAll{ ... }

.newsItem { ... }
.newsItem .newsItem--date{ ... }
.newsItem .newsItem--title{ ... }
.newsItem .newsItem--link{ ... }
```

要素の表示順にCSSを記述するのではなく、セクショニングコンテンツごとにまとめてCSSを記述することで、
CSSのまとまりがより理解しやすくなります。
このようなCSSを記述する際にはSCSSの入れ子を利用することで、よりコードのまとまりは理解しやすくなるでしょう。

CSSのまとまりがHTML上のセクショニングコンテンツと紐づく形で
適切に把握できるようになれば、セクショニングコンテンツ単位での削除や修正に伴う、
適切なCSS修正箇所の発見は容易になり、修正にかかるコストやコードの保守の負担は削減されるでしょう。

#### 汎用的なCSSの記述

CSSによるデザインの見え方は、
要素そのものに与えられたCSSの属性だけでなく、
親要素から継承されたプロパティにも大きく影響されます。

どのような親要素の下であってもある程度適切に表示させるためには、
いくつかCSSを記述する上での注意が必要です。

**em vs rem** 文字のサイズを`rem` や `px` で記述する場合、
配置された親要素の文字サイズに関係なく固定の文字サイズが採用されるため、
場合によっては文字が大きすぎたり、小さすぎたりといった問題が発生します。
文字サイズを周囲とあわせて設定したい場合には `em` を利用する方がベターです。

**margin/paddingの管理** 本来そのセクショニングコンテンツが持つべきmarginやpadding, borderと言った要素を
親要素で定義してしまった場合、そのセクショニングコンテンツがなくなったり変化したりした際に、
親要素に不要な余白や枠線が残ったりするかもしれません。
とりあえず見せるために雰囲気で書きがちなmarginやpaddingですが、
「どの要素が持つべきか」を考えながら適切さに注意して記述することで、修正時の負担は軽減されるでしょう。

**colors** 文字色や背景色などの指定も、適切な要素で実施すべきです。
要素内で特別な文字色、背景色を用いる場合、たとえそれが親要素から継承されていたとしても、
明示的にセクショニングコンテンツ内で再定義しておくことで、
セクショニングコンテンツが現在の親要素から離れた際にも見た目を維持することが可能です。

## レイアウトコーディングのテクニック

最後に、レイアウト関連のコーディングを行う際に必須となるコーディング上の概念をいくつか紹介していきます。

CodePenなどのツールを用いながら実際にコーディングの流れを確認しておきましょう。

### ブロック要素とインライン要素

HTML上の要素は、大きくブロック要素とインライン要素に分かれます。

ブロック要素は、divやsectionなどのHTMLで記述される要素で、
通常フローに置いて、要素の前後に改行を生成します（他の要素と横に並ばない）。

インライン要素は、aやspanなどのHTMLで記述される要素で、
通常フローに置いて、要素の前後に改行を生成せず、インライン要素同士は横並びで表示されます。

CSS要素の中には、 ブロック要素でしか適用されないものが存在するため、
ブロック・インラインの種別には注意が必要です。

例えば `height` `width` `margin` `padding` など [CSS基本ボックスモデル](https://developer.mozilla.org/ja/docs/Web/CSS/CSS_Box_Model)
を定義するプロパティはブロック要素でのみ有効なプロパティとなります。

HTMLの各要素は、要素ごとに標準のブロック・インラインの区別を持っていますが、
CSSプロパティの `display` を用いてこれを変更することも可能です。

https://developer.mozilla.org/ja/docs/Web/CSS/display-outside

### 横に並べるコーディング

要素を横に並べる方法は、様々なものがあります。

`position:absolute` や `float` を使った方法は古くから存在する手法ですが、
レイアウトの概念が親要素から独立するため、とても取り扱いが悪く、多用することはおすすめしません。

単純に横並べを実現する場合 `display:inline-block` を用いる方法が簡単です。

```html
<div class="list-item">apple</div>
<div class="list-item">lemon</div>
<div class="list-item">banana</div>

<style>
.list-item{
    display: inline-block;
}    
</style>
```

`display:inline-block` は簡単に横並びを実現できますが、
要素間に微妙なスペースが空いてしまうという問題があります。

要素間のスペースを厳密に処理したい場合は、 `display:table-cell` を用いることもできます。

 
```html
<div class="list-group">
    <div class="list-item">apple</div>
    <div class="list-item">lemon</div>
    <div class="list-item">banana</div>
</div>
 
<style>
.list-group{
    display: table;
    border-spacing: 2px 0;
    border-collapse: separate;
}
.list-item{
    display: table-cell;
}    
</style>
```

`border-spacing` は要素の両端にスペースを設けることが可能ですが、
両端のアイテムにもスペースが適用されてしまうという問題があります。

もし両端にはスペースを適用せず、要素と要素の間にのみスペースを適用したいという場合には、
次に紹介するFlexboxを利用すると良いでしょう。

### Flexbox

flexboxは柔軟にレイアウトを組むことが可能な新しいCSSプロパティです。

```html
<div class="list-group">
    <div class="list-item">apple</div>
    <div class="list-item">lemon</div>
    <div class="list-item">banana</div>
</div>
 
<style>
.list-group{
    display: flex;
    justify-content: space-between;
}
</style>
```

親要素に `display:flex` を適用することで、簡単に内部の要素を横並びにすることができます。

`display:flex` とセットで使用するプロパティ `justify-content` は横軸での要素の並びを調整できるプロパティで、
`space-between`のように設定することで、両端を除く要素同士の隙間にのみスペースを適用することが可能になります。

[CSS flexible box の利用 \| MDN](https://developer.mozilla.org/ja/docs/Web/CSS/CSS_Flexible_Box_Layout/Using_CSS_flexible_boxes)

### ブロック要素の垂直・水平中央揃え

ブロック要素を親要素に対して水平中央揃えする場合は、
左右のマージンをautoで設定します。

```
.box{
  width: 200px;
  margin-right: auto;
  margin-left: auto;
}
```

想像に反して、`margin-top` `margin-bottom` の値を `auto` で設定しても、
垂直方向で中央に配置されることはありません。

水平方向の中央揃えを行いたい場合には `flexbox` の `align-items: center` を用いると良いでしょう。

[align-items | MDN](https://developer.mozilla.org/ja/docs/Web/CSS/align-items#)

### ブロックとマージンの管理

マージンの相殺は大きな問題です。

上下に並ぶコンテンツのうち、上の要素のmargin-bottomと下の要素のmargin-topはお互いに相殺され、
大きい方値のみがマージンとして適用されます。

<p data-height="265" data-theme-id="0" data-slug-hash="gZpZJQ" data-default-tab="css,result" data-user="mikakane" data-pen-title="CSS 実践講座 マージンの相殺" class="codepen">See the Pen <a href="https://codepen.io/mikakane/pen/gZpZJQ/">CSS 実践講座 マージンの相殺</a> by mikakane (<a href="https://codepen.io/mikakane">@mikakane</a>) on <a href="https://codepen.io">CodePen</a>.</p>

また、親要素内の小要素に設定されたマージンのうち、  
一番最初の小要素のmargin-topは、親要素のmargin-topとして認識され  
一番最後の子要素のmargin-bottomは親要素のmargin-bottomとして認識されます。
親要素がすでに `margin-top` `margin-bottom` を持っている場合、
大きい方の値が `margin` として適用されます。

この親子間でのマージンの相殺は、 以下のようなケースでは生じないため、更に注意が必要です。

- 親要素がborderを設定している場合
- 親要素がpaddingを設定している場合
- 親要素がインラインコンテンツをもつ場合
- 親要素に `overflow: hidden` が設定されている場合

[マージンの相殺 | MDN](https://developer.mozilla.org/ja/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing)

マージンの仕様として相殺を理解するのはもちろん大事ですが、
全体でマージンの付け方のポリシーを設定するのも重要です。

上下でマージンを設定する場合相殺が起こるので、要素感の垂直方向のマージンは、
`margin-bottom` で設定するか、`margin-top` で設定するかを統一しておくのが良いでしょう。

通常サイトの開始いちでマージンが生じるケースは少ないので、
特に問題がない限り `margin-bottom` で統一するのがおすすめです。

  
